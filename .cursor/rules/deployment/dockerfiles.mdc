---
description:
globs:
alwaysApply: false
---
# Dockerfile and Docker Compose Conventions

## Objective
To ensure Docker images are built efficiently, securely, and are maintainable.

## Context
- Docker used for containerization (development and production).
- Multi-stage Docker builds are preferred (as hinted in README).

## Rules

### Dockerfile Best Practices
- **Minimal Base Images**: Use official, minimal base images (e.g., `python:3.13-slim`).
- **Multi-stage Builds**: Utilize multi-stage builds to reduce final image size (e.g., separate build stage for compiling assets or Python dependencies).
- **Layer Ordering**: Order Dockerfile instructions to leverage caching effectively (less frequently changing layers first).
- **Non-root User**: Run applications as a non-root user inside the container.
- **Least Privilege**: Only include necessary files and dependencies in the final image.
- **`.dockerignore`**: Use a comprehensive `.dockerignore` file.

### Docker Compose (`docker-compose.yml`)
- **Development Environment**: Define services for easy local development setup (app, database, redis, etc.).
- **Environment Variables**: Manage configuration through environment variables, not hardcoded in compose files.
- **Volumes**: Use volumes for persistent data and code mounting in development.

## Exceptions
- Specific build tools might require different Dockerfile structures.
